webpackJsonp([9,44,45],{"0vFV":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("Dd8w"),i=a.n(o),n=a("BO1k"),s=a.n(n),r=a("pFYg"),l=a.n(r),d=a("5YCd"),c=a("dnOL"),u={name:"Book",components:{bookAdd:d.default,bookEdit:c.default},data:function(){return{advanced:!1,dataSource:[],selectedRowKeys:[],selectedRows:null,paginationInfo:null,pagination:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(e,t){return"显示 "+t[0]+" ~ "+t[1]+" 条记录，共 "+e+" 条记录"}},queryParams:{},bookAddVisiable:!1,bookEditVisiable:!1,loading:!1}},computed:{columns:function(){return[{title:"ID",dataIndex:"id"},{title:"书名",dataIndex:"name"},{title:"作者",dataIndex:"author"},{title:"出版日期",dataIndex:"pulishDate"},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},fixed:"right",width:100}]}},mounted:function(){this.fetch()},methods:{onSelectChange:function(e,t){this.selectedRowKeys=e,console.log(e.length+", "+(void 0===t?"undefined":l()(t))),console.log(t[0].author);var a=!0,o=!1,i=void 0;try{for(var n,r=s()(e);!(a=(n=r.next()).done);a=!0){var d=n.value;console.log(this.dataSource[d].id),console.log(this.dataSource[d].author)}}catch(e){o=!0,i=e}finally{try{!a&&r.return&&r.return()}finally{if(o)throw i}}},toggleAdvanced:function(){this.advanced=!this.advanced,this.advanced||(this.queryParams.fieldName="")},handleBookAddSuccess:function(){this.bookAddVisiable=!1,this.$message.success("新增书籍成功"),this.search()},handleBookAddClose:function(){this.bookAddVisiable=!1},add:function(){this.bookAddVisiable=!0},handleBookEditSuccess:function(){this.bookEditVisiable=!1,this.$message.success("修改书籍成功"),this.search()},handleBookEditClose:function(){this.bookEditVisiable=!1},edit:function(e){this.$refs.bookEdit.setFormValues(e),this.bookEditVisiable=!0},batchDelete:function(){if(this.selectedRowKeys.length){var e=this;this.$confirm({title:"确定删除所选中的记录?",content:"当您点击确定按钮后，这些记录将会被彻底删除",centered:!0,onOk:function(){var t=[],a=!0,o=!1,i=void 0;try{for(var n,r=s()(e.selectedRowKeys);!(a=(n=r.next()).done);a=!0){var l=n.value;t.push(e.dataSource[l].id)}}catch(e){o=!0,i=e}finally{try{!a&&r.return&&r.return()}finally{if(o)throw i}}e.$delete("book/"+t.join(",")).then(function(){e.$message.success("删除成功"),e.selectedRowKeys=[],e.search()})},onCancel:function(){e.selectedRowKeys=[]}})}else this.$message.warning("请选择需要删除的记录")},exportExcel:function(){this.$export("book/excel",i()({},this.queryParams))},search:function(){this.fetch(i()({},this.queryParams))},reset:function(){this.selectedRowKeys=[],this.$refs.TableInfo.pagination.current=this.pagination.defaultCurrent,this.paginationInfo&&(this.paginationInfo.current=this.pagination.defaultCurrent,this.paginationInfo.pageSize=this.pagination.defaultPageSize),this.paginationInfo=null,this.queryParams={},this.fetch()},handleTableChange:function(e,t,a){this.paginationInfo=e,this.fetch(i()({},this.queryParams))},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,t.pageSize=this.paginationInfo.pageSize,t.pageNum=this.paginationInfo.current):(t.pageSize=this.pagination.defaultPageSize,t.pageNum=this.pagination.defaultCurrent),this.$get("book",i()({},t)).then(function(t){var a=t.data,o=i()({},e.pagination);o.total=a.total,e.loading=!1,e.dataSource=a.rows,e.pagination=o})}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[a("div",{class:e.advanced?"search":null},[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{class:e.advanced?null:"fold"},[a("a-row",[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"书名",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[a("a-input",{model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name",t)},expression:"queryParams.name"}})],1)],1),e._v(" "),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"作者",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[a("a-input",{model:{value:e.queryParams.author,callback:function(t){e.$set(e.queryParams,"author",t)},expression:"queryParams.author"}})],1)],1)],1)],1),e._v(" "),a("span",{staticStyle:{float:"right","margin-top":"3px"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")]),e._v(" "),a("a",{staticStyle:{"margin-left":"8px"},on:{click:e.toggleAdvanced}},[e._v("\n          "+e._s(e.advanced?"收起":"展开")+"\n          "),a("a-icon",{attrs:{type:e.advanced?"up":"down"}})],1)],1)])],1),e._v(" "),a("div",[a("div",{staticClass:"operator"},[a("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"book:add",expression:"'book:add'"}],attrs:{type:"primary",ghost:""},on:{click:e.add}},[e._v("新增")]),e._v(" "),a("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"book:delete",expression:"'book:delete'"}],on:{click:e.batchDelete}},[e._v("删除")]),e._v(" "),a("a-dropdown",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"book:export",expression:"'book:export'"}]},[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"export-data",on:{click:e.exportExcel}},[e._v("导出Excel")])],1),e._v(" "),a("a-button",[e._v("\n          更多操作 "),a("a-icon",{attrs:{type:"down"}})],1)],1)],1),e._v(" "),a("a-table",{ref:"TableInfo",attrs:{columns:e.columns,dataSource:e.dataSource,pagination:e.pagination,loading:e.loading,rowSelection:{selectedRowKeys:e.selectedRowKeys,selectedRows:e.selectedRows,onChange:e.onSelectChange},scroll:{x:900}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"remark",fn:function(t,o){return[a("a-popover",{attrs:{placement:"topLeft"}},[a("template",{slot:"content"},[a("div",{staticStyle:{"max-width":"200px"}},[e._v(e._s(t))])]),e._v(" "),a("p",{staticStyle:{width:"200px","margin-bottom":"0"}},[e._v(e._s(t))])],2)]}},{key:"operation",fn:function(t,o){return[a("a-icon",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"book:update",expression:"'book:update'"}],attrs:{type:"setting",theme:"twoTone",twoToneColor:"#4a9ff5",title:"修改书籍"},on:{click:function(t){e.edit(o)}}}),e._v(" "),a("a-badge",{directives:[{name:"hasNoPermission",rawName:"v-hasNoPermission",value:"book:update",expression:"'book:update'"}],attrs:{status:"warning",text:"无权限"}})]}}])})],1),e._v(" "),a("book-add",{attrs:{bookAddVisiable:e.bookAddVisiable},on:{close:e.handleBookAddClose,success:e.handleBookAddSuccess}}),e._v(" "),a("book-edit",{ref:"bookEdit",attrs:{bookEditVisiable:e.bookEditVisiable},on:{close:e.handleBookEditClose,success:e.handleBookEditSuccess}})],1)},staticRenderFns:[]};var h=a("VU/8")(u,m,!1,function(e){a("4da+")},"data-v-2430cb2d",null);t.default=h.exports},"4da+":function(e,t){},"5YCd":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("Dd8w"),i=a.n(o),n={labelCol:{span:3},wrapperCol:{span:18}},s={name:"BookAdd",components:{CancelButton:a("v7vj").a},props:{bookAddVisiable:{default:!1}},data:function(){return{loading:!1,formItemLayout:n,form:this.$form.createForm(this),book:{}}},methods:{reset:function(){this.loading=!1,this.book={},this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var e=this;this.form.validateFields(function(t,a){t||e.$post("book",i()({},e.book)).then(function(){e.reset(),e.$emit("success")}).catch(function(){e.loading=!1})})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:"新增书籍",maskClosable:!0,width:"650",placement:"right",closable:!1,visible:e.bookAddVisiable},on:{close:e.onClose}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",e._b({attrs:{label:"书名"}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"不能为空"}]}],expression:"['name',\n                 {rules: [\n                  { required: true, message: '不能为空'}\n                ]}]"}],staticStyle:{width:"100%"},model:{value:e.book.name,callback:function(t){e.$set(e.book,"name",t)},expression:"book.name"}})],1),e._v(" "),a("a-form-item",e._b({attrs:{label:"作者"}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["author",{rules:[{required:!0,message:"不能为空"},{max:20,message:"长度不能超过20个字符"}]}],expression:"['author',\n                 {rules: [\n                  { required: true, message: '不能为空'},\n                  { max: 20, message: '长度不能超过20个字符'}\n                ]}]"}],model:{value:e.book.author,callback:function(t){e.$set(e.book,"author",t)},expression:"book.author"}})],1),e._v(" "),a("a-form-item",e._b({attrs:{label:"出版日期"}},"a-form-item",e.formItemLayout,!1),[a("a-date-picker",{attrs:{showTime:"",format:"YYYY-MM-DD HH:mm:ss",placeholder:"选择出版日期"},model:{value:e.book.pulishDate,callback:function(t){e.$set(e.book,"pulishDate",t)},expression:"book.pulishDate"}})],1)],1),e._v(" "),a("div",{staticClass:"drawer-bootom-button"},[a("cancel-button",{on:{close:e.onClose}}),e._v(" "),a("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},staticRenderFns:[]},l=a("VU/8")(s,r,!1,null,null,null);t.default=l.exports},dnOL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("Dd8w"),i=a.n(o),n=a("fZjL"),s=a.n(n),r=a("+6Bu"),l=a.n(r),d=a("v7vj"),c=a("PJh5"),u=a.n(c);u.a.locale("zh-cn");var m={labelCol:{span:3},wrapperCol:{span:18}},h={name:"BookEdit",components:{CancelButton:d.a},props:{bookEditVisiable:{default:!1}},data:function(){return{loading:!1,formItemLayout:m,form:this.$form.createForm(this),book:{}}},methods:{reset:function(){this.loading=!1,this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},setFormValues:function(e){var t=this,a=l()(e,[]),o=["name","author","pulishDate"];s()(a).forEach(function(e){if(-1!==o.indexOf(e)){t.form.getFieldDecorator(e);var i={};i[e]=a[e],"pulishDate"===e?t.form.setFieldsValue({pulishDate:u()(a[e])}):t.form.setFieldsValue(i)}}),this.book.id=a.id},handleSubmit:function(){var e=this;this.form.validateFields(function(t,a){if(!t){var o=e.form.getFieldsValue();o.id=e.book.id,e.$put("book",i()({},o)).then(function(){e.reset(),e.$emit("success")}).catch(function(){e.loading=!1})}})}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:"修改书籍",maskClosable:!1,width:"650",placement:"right",closable:!1,visible:e.bookEditVisiable},on:{close:e.onClose}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",e._b({attrs:{label:"书名"}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"不能为空"}]}],expression:"['name',\n                 {rules: [\n                  { required: true, message: '不能为空'}\n                ]}]"}],staticStyle:{width:"100%"}})],1),e._v(" "),a("a-form-item",e._b({attrs:{label:"作者"}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["author",{rules:[{required:!0,message:"不能为空"},{max:20,message:"长度不能超过20个字符"}]}],expression:"['author',\n                 {rules: [\n                  { required: true, message: '不能为空'},\n                  { max: 20, message: '长度不能超过20个字符'}\n                ]}]"}]})],1),e._v(" "),a("a-form-item",e._b({attrs:{label:"出版日期"}},"a-form-item",e.formItemLayout,!1),[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["pulishDate"],expression:"['pulishDate']"}],attrs:{showTime:"",format:"YYYY-MM-DD HH:mm:ss",placeholder:"Select Time"}})],1)],1),e._v(" "),a("div",{staticClass:"drawer-bootom-button"},[a("cancel-button",{on:{close:e.onClose}}),e._v(" "),a("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},staticRenderFns:[]},p=a("VU/8")(h,f,!1,null,null,null);t.default=p.exports}});
//# sourceMappingURL=9.c4d0582ce11495cbb644.js.map